Скелет модуля
=============

Основной файл модуля
--------------------

Это единственный необходимый файл для создания модуля. Он должен иметь имя ``имя_плагина.php``, при этом имя должно записываться в нижнем регистре и может состоять из цифр, латинских букв и символа подчёркивания. Имя не может начинаться с цифры.

Файл должен содержать основной класс модуля.

Основной класс модуля
---------------------

Основной класс модуля должен быть унаследован от одного из базовых классов:

  * `Eresus_Plugin <../../api/classes/Eresus_Plugin.html>`_
  * `ContentPlugin <../../api/classes/ContentPlugin.html>`_

Имя класса плагина должно совпадать с именем плагина и, соответственно, его файла (пример: "MyPlugin").

Выбор базового класса
---------------------

Если ваш плагин должен :doc:`предоставлять тип контента (тип раздела)<../guide/providing_content_type>`, то он должен быть унаследован от `ContentPlugin <../../api/classes/ContentPlugin.html>`_.

Во всех остальных случаях в качестве базового класса следует использовать
`Eresus_Plugin <../../api/classes/Eresus_Plugin.html>`_.

.. code-block:: php

   <?php
   /**
    * Тестовый плагин
    * @package Demo
    */
   class MyPlugin extends Eresus_Plugin
   {
     ...
   }

Основные свойства модуля
------------------------

В объявлении основного класса плагина обязательно должен быть установлен ряд публичных свойств:

* `Eresus_Plugin::$version <../../api/classes/Eresus_Plugin.html#$version>`_ — строковое свойство, задающее версию плагина.
* `Eresus_Plugin::$kernel <../../api/classes/Eresus_Plugin.html#$kernel>`_ — строковое свойство, задающее минимальную необходимую для плагина версию CMS.
* `Eresus_Plugin::$title <../../api/classes/Eresus_Plugin.html#$title>`_ — строковое свойство, задающее название плагина.
* `Eresus_Plugin::$description <../../api/classes/Eresus_Plugin.html#$description>`_ — строковое свойство, задающее описание плагина.

Пример:

.. code-block:: php

   <?php
   /**
    * Тестовый плагин
    * @package Demo
    */
   class MyPlugin extends Eresus_Plugin
   {
     /**
      * Версия плагина
      * @var string
      */
     public $version = '1.00b';

     /**
      * Требуемая версия ядра
      * @var string
      */
     public $kernel = '3.00';

     /**
      * Название плагина
      * @var string
      */
     public $title = 'Мой плагин';

     /**
      * Описание плагина
      * @var string
      */
     public $description = 'Описание плагина';
   }


Итог
----

Кода, приведённого в последнем примере, достаточно для подключения вашего плагина к CMS. Скопируйте основной файл в папку ``ext/`` и попробуйте добавить его через управление модулями расширения.

Шаблон модуля
-------------

В дистрибутиве, в папке ``SDK/plugin_template`` расположена заготовка, которую вы можете использовать его для создания своего модуля. Этот шаблон состоит из следующих файлов и директорий:

* ``src/`` --- исходные коды модуля

  * ``myplugin/`` --- дополнительные файлы модуля (начиная с 2.16)

    * ``plugin.xml`` --- :doc:`описание модуля<plugin.xml>`
  * ``myplugin.php`` --- основной файл модуля
* ``tests/`` --- автоматические тесты

  * ``phpunit`` --- тесты `PHPUnit <http://phpunit.de/>`_
* ``.gitignore`` --- файл исключений для Git
* ``build.properties`` --- параметры сборки для ``build.xml``
* ``build.xml`` --- файл сборки для `phing <http://phing.info/>`_
